---
import BaseLayout from "../layouts/BaseLayout.astro";
import PalmaresModal from "../components/PalmaresModal.astro";
import {
  campeonesData,
  erasConfig,
  recordCampeones,
  recordEtapas,
  nuevaGeneracionData,
} from "../data/palmares";

// SEO por página
const pageTitle = "Palmarés Histórico - Campeones La Doble Bragado 1922-2025";
const pageDescription =
  "104 años de historia ciclista argentina. Descubrí todos los campeones de La Doble Bragado desde 1922 hasta 2025. Timeline interactivo, estadísticas y eras históricas.";
const pageKeywords =
  "La Doble Bragado, campeones, ciclismo argentino, historia, palmarés, Cosme Saavedra, Juan Curuchet, Maribel Aguirre, Darío Colla";

// JSON-LD (vía BaseLayout)
const structuredData = {
  "@context": "https://schema.org",
  "@type": "SportsEvent",
  name: "La Doble Bragado - Palmarés Histórico",
  description:
    "Competencia ciclista histórica argentina con 104 años de tradición.",
  startDate: "1922",
  endDate: "2025",
  location: {
    "@type": "Place",
    name: "Bragado, Buenos Aires, Argentina",
    address: {
      "@type": "PostalAddress",
      addressLocality: "Bragado",
      addressRegion: "Buenos Aires",
      addressCountry: "AR",
    },
  },
  organizer: { "@type": "Organization", name: "La Doble Bragado" },
  sport: "Cycling",
  winner: [
    { "@type": "Person", name: "Cosme Saavedra", award: "6 títulos (1924-1930)" },
    { "@type": "Person", name: "Mario Mathieu", award: "5 títulos (1935-1942)" },
    { "@type": "Person", name: "Juan Curuchet", award: "4 títulos (1997-2003)" },
    { "@type": "Person", name: "Nicolás Traico", award: "Campeón 2025" },
    { "@type": "Person", name: "Maribel Aguirre", award: "Bicampeona Femenina (2023-2024)" },
  ],
};

// Mapeo exacto de fotos por nombre (respetando mayúsculas del archivo)
const fotoCampeones: Record<string, string> = {
  'Cosme Saavedra': '/images/fotos-campeones/cosme-saavedra-campeon.jpg',
  'Mario Mathieu': '/images/fotos-campeones/Mario-Mathieu-campeon.jpg',
  'Juan Curuchet': '/images/fotos-campeones/Juan-Curuchet-campeon.jpg',
  'Laureano Rosas': '/images/fotos-campeones/laureano-rosas-campeon.jpg',
  // NUEVOS: Colla / Pérez / Antogna
  'Ángel Darío Colla': '/images/fotos-campeones/Dario-Colla-Matador.jpg',
  'Walter Pérez': '/images/fotos-campeones/Walter-Perez.jpg',
  'Fernando Antogna': '/images/fotos-campeones/Fernando-Antogna.jpg',
};
---

<BaseLayout
  title={pageTitle}
  description={pageDescription}
  keywords={pageKeywords}
  structuredData={structuredData}
>
  <main role="main">
    <!-- HERO (LCP con <img>) -->
    <section
      id="campeones"
      class="h-screen flex items-center justify-center relative text-center"
      aria-labelledby="campeones-title"
    >
      <img
        src="/images/dario-historia-v4.jpg"
        alt=""
        fetchpriority="high"
        decoding="async"
        class="absolute inset-0 w-full h-full object-cover"
      />
      <div class="absolute inset-0 bg-black/30" aria-hidden="true"></div>

      <div class="text-white z-10 max-w-5xl px-8">
        <h1
          id="campeones-title"
          class="font-display font-black text-6xl md:text-7xl lg:text-8xl mb-6 leading-tight text-amarillo"
        >
          PALMARÉS<br />HISTÓRICO
        </h1>
        <p class="text-xl md:text-3xl mb-8 opacity-90 font-semibold max-w-4xl mx-auto">
          104 años de leyenda ciclística argentina
        </p>
        <div class="text-lg md:text-xl opacity-80 max-w-3xl mx-auto">
          Desde Eugenio Gret (1922) hasta Nicolás Traico (2025).<br />
          <span class="text-amarillo font-semibold">
            88 ediciones masculinas • 2 ediciones femeninas • 75 campeones únicos
          </span>
        </div>
      </div>
    </section>

    <!-- STATS -->
    <section class="bg-oscuro py-20" aria-labelledby="stats-title">
      <div class="max-w-7xl mx-auto px-8">
        <header class="text-center mb-16">
          <h2 id="stats-title" class="font-display font-black text-5xl md:text-5xl text-white mb-4 uppercase">
            La Doble en Números
          </h2>
          <p class="text-xl text-amarillo font-semibold">Los datos que cuentan más de un siglo de historia</p>
        </header>

        <div class="grid grid-cols-2 md:grid-cols-4 gap-8 mb-16">
          <div class="text-center">
            <span class="font-sans font-black text-5xl md:text-6xl text-amarillo block mb-2">104</span>
            <span class="text-lg font-semibold uppercase tracking-wider text-white">Años de Historia</span>
          </div>
          <div class="text-center">
            <span class="font-sans font-black text-5xl md:text-6xl text-amarillo block mb-2">88</span>
            <span class="text-lg font-semibold uppercase tracking-wider text-white">Ediciones Masculinas</span>
          </div>
          <div class="text-center">
            <span class="font-sans font-black text-5xl md:text-6xl text-amarillo block mb-2">2</span>
            <span class="text-lg font-semibold uppercase tracking-wider text-white">Ediciones Femeninas</span>
          </div>
          <div class="text-center">
            <span class="font-sans font-black text-5xl md:text-6xl text-amarillo block mb-2">75</span>
            <span class="text-lg font-semibold uppercase tracking-wider text-white">Campeones Únicos</span>
          </div>
        </div>
      </div>
    </section>

<!-- RÉCORD DE TÍTULOS (tarjetas ~25% más bajas y textos alineados casi al tope de la foto) -->
<section class="bg-grisclaro py-14" aria-labelledby="record-campeones-title">
  <div class="max-w-6xl mx-auto px-4">
    <header class="text-center mb-10">
      <h2 id="record-campeones-title" class="font-display font-black text-3xl md:text-5xl text-oscuro mb-2 uppercase">
        Récord de Títulos
      </h2>
      <p class="text-lg text-celeste font-medium">Los máximos ganadores en la historia</p>
    </header>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-7 max-w-5xl mx-auto">
      {
        (() => {
          // Orden de fotos (se repiten si hay >4 tarjetas)
          const fotosCampeones = [
            "/images/fotos-campeones/cosme-saavedra-campeon.jpg",
            "/images/fotos-campeones/Mario-Mathieu-campeon.jpg",
            "/images/fotos-campeones/Juan-Curuchet-campeon.jpg",
            "/images/fotos-campeones/laureano-rosas-campeon.jpg",
          ];

          return recordCampeones.map((campeon, index) => (
            <article
              class="rounded-3xl px-6 py-3.5 shadow-xl hover:-translate-y-2 transition-transform duration-300 motion-reduce:transition-none motion-reduce:transform-none bg-oscuro/90 text-white ring-1 ring-amarillo/30 hover:ring-amarillo/60"
            >
              <!-- Grid de 3 columnas: Nº | textos | foto  -->
              <div class="grid grid-cols-[auto,1fr,auto] items-start gap-3">
                <!-- Nº de ranking -->
                <span class="font-display font-black text-4xl leading-none w-12 h-12 rounded-lg flex items-center justify-center bg-amarillo text-oscuro shrink-0">
                  {index + 1}
                </span>

                <!-- Textos (suben casi al tope de la foto) -->
                <div class="min-w-0">
                  <h3 class="font-sans text-xl font-black text-white truncate">{campeon.nombre}</h3>
                  <p class="font-sans text-sm text-white/70">{campeon.periodo}</p>

                  <div class="mt-1.5">
                    <p class="font-sans text-xs uppercase tracking-wider text-amarillo/90">Títulos</p>
                    <div class="flex items-end gap-2 mt-0.5">
                      <span class="font-display font-black text-6xl leading-none text-white">
                        {campeon.victorias}
                      </span>
                      <div class="flex flex-wrap gap-1" aria-hidden="true">
                        {
                          Array.from({ length: campeon.victorias }).map((_, i) => (
                            <span class="text-amarillo text-2xl md:text-3xl leading-none">★</span>
                          ))
                        }
                      </div>
                    </div>
                  </div>
                </div>

                <!-- FOTO: 120x150px (derecha) -->
                <div class="rounded-2xl overflow-hidden border-2 border-white/25 bg-white/5 shadow shrink-0">
                  <img
                    src={fotosCampeones[index % fotosCampeones.length]}
                    alt={`Foto de ${campeon?.nombre || 'campeón'}`}
                    class="w-[120px] h-[150px] object-cover"
                    loading="lazy"
                    decoding="async"
                  />
                </div>
              </div>
            </article>
          ));
        })()
      }
    </div>
  </div>
</section>


<!-- RÉCORD DE ETAPAS (mismo tamaño que las tarjetas de Récord de Títulos) -->
<section class="bg-white py-16" aria-labelledby="record-etapas-title">
  <div class="max-w-6xl mx-auto px-4">
    <header class="text-center mb-12">
      <h2 id="record-etapas-title" class="font-display font-black text-3xl md:text-5xl text-oscuro mb-3 uppercase">
        Récord Ganadores de Etapas
      </h2>
      <p class="text-lg text-celeste font-medium">Los ciclistas que más etapas conquistaron</p>
    </header>

    <!-- Misma rejilla que Récord de Títulos -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-7 max-w-5xl mx-auto">
      {
        recordEtapas.map((corredor, index) => {
          const isColla = corredor.destacado;

          // Foto: Colla / Pérez / Antogna / Rosas / Curuchet / fallback Saavedra
          const nombre = (corredor?.nombre || "").toLowerCase();
          const fotoSrc =
            nombre.includes("colla")
              ? "/images/fotos-campeones/Dario-Colla-Matador.jpg"
              : (nombre.includes("pérez") || nombre.includes("perez"))
              ? "/images/fotos-campeones/Walter-Perez.jpg"
              : nombre.includes("antogna")
              ? "/images/fotos-campeones/Fernando-Antogna.jpg"
              : nombre.includes("rosas")
              ? "/images/fotos-campeones/laureano-rosas-campeon.jpg"
              : nombre.includes("curuchet")
              ? "/images/fotos-campeones/Juan-Curuchet-campeon.jpg"
              : "/images/fotos-campeones/cosme-saavedra-campeon.jpg";

          return (
            <article
              class={`rounded-3xl px-6 py-3.5 shadow-xl hover:-translate-y-2 transition-transform duration-300 motion-reduce:transition-none motion-reduce:transform-none
                ${isColla ? "bg-amarillo text-oscuro ring-1 ring-oscuro/10 hover:ring-oscuro/20" : "bg-celeste text-white ring-1 ring-white/20 hover:ring-white/40"}`}
            >
              <!-- Misma grilla: Nº | textos | foto -->
              <div class="grid grid-cols-[auto,1fr,auto] items-start gap-3">
                <!-- Nº -->
                <span class={`font-display font-black text-4xl leading-none w-12 h-12 rounded-lg flex items-center justify-center shrink-0
                  ${isColla ? "bg-oscuro/10 text-oscuro" : "bg-white/20 text-white"}`}>
                  {index + 1}
                </span>

                <!-- Textos (alineados y sin truncar) -->
                <div class="min-w-0">
                  <h3 class={`font-sans text-xl font-bold whitespace-normal break-words ${isColla ? "text-oscuro" : "text-white"}`}>
                    {corredor.nombre}
                  </h3>
                  <div class="mt-1.5">
                    <p class={`font-sans text-xs uppercase tracking-wider ${isColla ? "text-oscuro/80" : "text-white/80"}`}>
                      Etapas ganadas
                    </p>
                    <div class="flex items-end gap-2 mt-0.5">
                      <span class={`font-display font-black text-6xl leading-none ${isColla ? "text-oscuro" : "text-white"}`}>
                        {corredor.etapas}
                      </span>
                    </div>
                  </div>
                </div>

                <!-- FOTO 120×150 (derecha) -->
                <div class={`rounded-2xl overflow-hidden border-2 shadow shrink-0
                    ${isColla ? "border-oscuro/20 bg-oscuro/5" : "border-white/25 bg-white/10"}`}>
                  <img
                    src={fotoSrc}
                    alt={`Foto de ${corredor?.nombre || "corredor"}`}
                    class="w-[120px] h-[150px] object-cover"
                    loading="lazy"
                    decoding="async"
                  />
                </div>
              </div>
            </article>
          );
        })
      }
    </div>
  </div>
</section>


<!-- NUEVA GENERACIÓN (mismo tamaño que las tarjetas de Récord de Títulos) -->
<section class="bg-oscuro py-16" aria-labelledby="nueva-generacion-title">
  <div class="max-w-6xl mx-auto px-6">
    <header class="text-center mb-12">
      <h2 id="nueva-generacion-title" class="font-display font-black text-3xl md:text-5xl text-white mb-3 uppercase">
        Nueva Generación
      </h2>
      <p class="text-lg text-amarillo font-medium">Los campeones que escriben el presente</p>
    </header>

    <!-- Misma rejilla que Récord de Títulos -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-7 max-w-5xl mx-auto">
      {
        nuevaGeneracionData.map((campeon) => {
          const isFemenino = campeon.categoria === "femenino";

          // FOTO POR NOMBRE (reemplazo de Saavedra por cada corredor)
          const nombre = (campeon?.nombre || "").toLowerCase();
          const fotoSrc =
            nombre.includes("elbio") || nombre.includes("alborzen")
              ? "/images/Fotos-nueva-generacion/Elbio-Alborzen-2022.jpg"
              : nombre.includes("maribel") || nombre.includes("aguirre")
              ? "/images/Fotos-nueva-generacion/Maribel-Aguirre-2023-2024.jpg"
              : nombre.includes("traico")
              ? "/images/Fotos-nueva-generacion/Nicolas-Traico-2025.jpg"
              : nombre.includes("azzem")
              ? "/images/Fotos-nueva-generacion/Omar-Azzem-2024.jpg"
              : nombre.includes("fredes")
              ? "/images/Fotos-nueva-generacion/Sergio-Fredes-2023.jpg"
              : nombre.includes("colla")
              ? "/images/fotos-campeones/Dario-Colla-Matador.jpg"
              : (nombre.includes("pérez") || nombre.includes("perez"))
              ? "/images/fotos-campeones/Walter-Perez.jpg"
              : nombre.includes("antogna")
              ? "/images/fotos-campeones/Fernando-Antogna.jpg"
              : nombre.includes("rosas")
              ? "/images/fotos-campeones/laureano-rosas-campeon.jpg"
              : nombre.includes("curuchet")
              ? "/images/fotos-campeones/Juan-Curuchet-campeon.jpg"
              : "/images/fotos-campeones/cosme-saavedra-campeon.jpg";

          return (
            <div
              class={
                isFemenino
                  ? "bg-rosa rounded-3xl px-6 py-3.5 shadow-xl hover:-translate-y-2 hover:shadow-2xl transition-transform duration-300 motion-reduce:transition-none motion-reduce:transform-none"
                  : "bg-grisclaro rounded-3xl px-6 py-3.5 ring-1 ring-amarillo/20 shadow-xl hover:-translate-y-2 hover:shadow-2xl transition-transform duration-300 motion-reduce:transition-none motion-reduce:transform-none"
              }
            >
              <!-- Misma grilla: Año | textos | foto -->
              <div class="grid grid-cols-[auto,1fr,auto] items-start gap-3">
                <!-- Año -->
                <div class={`text-4xl font-black shrink-0 ${isFemenino ? "text-white" : "text-oscuro"}`}>
                  {campeon.año}
                </div>

                <!-- Textos -->
                <div class="min-w-0">
                  <h3 class={`font-bold text-lg whitespace-normal break-words ${isFemenino ? "text-white" : "text-oscuro"}`}>
                    {campeon.nombre}
                  </h3>
                  <div class={`text-sm font-medium ${isFemenino ? "text-white/90" : "text-oscuro/70"}`}>
                    Edición {isFemenino ? "Femenina" : "Masculina"} #{campeon.edicion}
                  </div>
                </div>

                <!-- FOTO 120×150 (derecha) -->
                <div class={`rounded-2xl overflow-hidden border-2 shadow shrink-0
                    ${isFemenino ? "border-white/30 bg-white/10" : "border-oscuro/10 bg-white"}`}>
                  <img
                    src={fotoSrc}
                    alt={`Foto de ${campeon?.nombre || "campeón/a"}`}
                    class="w-[120px] h-[150px] object-cover"
                    loading="lazy"
                    decoding="async"
                  />
                </div>
              </div>
            </div>
          );
        })
      }
    </div>
  </div>
</section>



    <!-- CTA TIMELINE -->
    <section
      class="relative bg-gradient-to-r from-violetaOscuro to-celeste py-20
             before:content-[''] before:absolute before:inset-x-0 before:top-0 before:h-0 before:bg-rosa
             after:content-[''] after:absolute after:inset-x-0 after:bottom-0 after:h-0 after:bg-amarillo"
      aria-labelledby="cta-timeline-title"
    >
      <div class="absolute top-0 left-0 w-full h-0.5 bg-gradient-to-r from-transparent via-rosa to-transparent"></div>
      <div class="max-w-4xl mx-auto px-8 text-center">
        <h2 id="cta-timeline-title" class="font-display font-black text-4xl md:text-5xl text-white mb-6 uppercase">
          Explora la Historia Completa
        </h2>
        <p class="text-xl text-white/90 mb-12 leading-relaxed">
          Descubrí todos los campeones, era por era, año por año. Un timeline interactivo con más de 100 años de ciclismo argentino.
        </p>
        <button
          data-open-palmares
          class="bg-white text-celeste px-12 py-6 rounded-3xl font-bold text-2xl hover:-translate-y-2 hover:shadow-2xl hover:bg-amarillo hover:text-oscuro transition-all duration-300 transform hover:scale-105 motion-reduce:transition-none motion-reduce:transform-none focus:outline-none focus:ring-2 focus:ring-celeste focus:ring-offset-2"
          aria-label="Ver palmarés completo"
        >
          Ver Palmarés Completo
        </button>
      </div>
    </section>

    <!-- MODAL REUTILIZABLE -->
    <PalmaresModal />
  </main>
</BaseLayout>
